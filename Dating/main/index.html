
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.13">
    
    
      
        <title>Main - Research Materials</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e411adfe.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cc9b2e1e.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dating-recommendation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Research Materials" class="md-header__button md-logo" aria-label="Research Materials" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Research Materials
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Main
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Research Materials" class="md-nav__button md-logo" aria-label="Research Materials" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Research Materials
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Main Page
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Conferences/" class="md-nav__link">
        Conferences
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Relevant%20Articles/" class="md-nav__link">
        Relevant Articles
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Dating
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Dating" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Dating
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Main
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Main
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dating-recommendation" class="md-nav__link">
    dating recommendation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#28032022" class="md-nav__link">
    Статус 28.03.2022
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    Для общего развития
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    Обзор литературы
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    К след . разу:
  </a>
  
    <nav class="md-nav" aria-label="К след . разу:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    Потом
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#07052022" class="md-nav__link">
    Статус 07.05.2022
  </a>
  
    <nav class="md-nav" aria-label="Статус 07.05.2022">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. Выгрузка данных и их очистка
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. Граф
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3. Несложные методы предсказания
  </a>
  
    <nav class="md-nav" aria-label="3. Несложные методы предсказания">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#testtrain" class="md-nav__link">
    Test/train
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    Метрики
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    Простые вероятностные методы
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node2vec" class="md-nav__link">
    Node2vec
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4. Обзор литературы
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Inflation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Inflation" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Inflation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Inflation/main/" class="md-nav__link">
        Встреча 30.03.2022
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Information Propagation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Information Propagation" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Information Propagation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Information%20Propagation/main/" class="md-nav__link">
        Встреча 29.03.2022
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dating-recommendation" class="md-nav__link">
    dating recommendation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#28032022" class="md-nav__link">
    Статус 28.03.2022
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    Для общего развития
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    Обзор литературы
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    К след . разу:
  </a>
  
    <nav class="md-nav" aria-label="К след . разу:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    Потом
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#07052022" class="md-nav__link">
    Статус 07.05.2022
  </a>
  
    <nav class="md-nav" aria-label="Статус 07.05.2022">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. Выгрузка данных и их очистка
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. Граф
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3. Несложные методы предсказания
  </a>
  
    <nav class="md-nav" aria-label="3. Несложные методы предсказания">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#testtrain" class="md-nav__link">
    Test/train
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    Метрики
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    Простые вероятностные методы
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node2vec" class="md-nav__link">
    Node2vec
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4. Обзор литературы
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h2 id="dating-recommendation">dating recommendation</h2>
<ul>
<li>Ссылка на постоянный созвон: <a href="https://us02web.zoom.us/j/84017944503?pwd=Y3paWTUzbXkrQWU2RGkyb21nQk1wdz09">zoom</a></li>
</ul>
<h2 id="28032022">Статус 28.03.2022</h2>
<p>Мотивирующая картинка</p>
<h2 id="_1"></h2>
<p><img alt="63cb813ed6b4ca81fc2fb2aad827ce3a.png" src="../Images/63cb813ed6b4ca81fc2fb2aad827ce3a.png" />
Решили что будем учить рекомендательную модель, которая будет прогнозировать насколько одному эмбеддингу понравится другой. Прогнозировать будем на основании трёх видов даннх (картинка, граф, текст, атрибуты). При этом модель нужно учить отдельно для newcommer'ов, отдельно для опытных пользователей т.к. у первых еще нет сетевого эмбеддинга.</p>
<h2 id="_2">Для общего развития</h2>
<p>Стенфордский курс по SNA <a href="https://www.notion.so/yads/Sberloga-with-Graphs-12fafe3224e1483eb435a16aa990e1a1">notion</a></p>
<p>Как учить GAT можно найти тут: <a href="https://github.com/gordicaleksa/pytorch-GAT/blob/main/The%20Annotated%20GAT%20(Cora).ipynb">colab</a>, но если лень разбираться, то он есть в <a href="https://stellargraph.readthedocs.io/en/stable/">stellar graph</a></p>
<h2 id="_3">Обзор литературы</h2>
<p>Берем хороший обзор по SNA link prediction, например A Survey of Link Recommendation for Social Networks: Methods, Theoretical Foundations, and Future Research Directions <a href="https://dl.acm.org/doi/10.1145/3131782">acm</a>, <a href="https://dl.acm.org/doi/pdf/10.1145/3131782">pdf</a> и смотрим <a href="https://scholar.google.com/scholar?hl=ru&amp;as_sdt=2005&amp;sciodt=0%2C5&amp;as_ylo=2018&amp;cites=13239567524783213560&amp;scipsc=1&amp;q=graph+attention+networks&amp;btnG=&amp;oq=graph+attention+">кто его процитировал в google scholar</a></p>
<p>Среди релевантных сразу находим статью из <a href="https://www.scimagojr.com/journalsearch.php?q=17362&amp;tip=sid&amp;clean=0">Q1</a> журнала 2022 года: "<a href="https://ieeexplore.ieee.org/abstract/document/9706322">What You Like, What I Am: Online Dating Recommendation via Matching Individual Preferences with Features</a>" <a href="https://dl.dropboxusercontent.com/s/i5bowxdgt3h08wc/What_You_Like_What_I_Am_Online_Dating_Recommendation_via_Matching_Individual_Preferences_with_Features.pdf">pdf</a></p>
<p>Также стоит посмотреть:
"<a href="https://dl.acm.org/doi/10.1007/978-3-642-30220-6_17">Reciprocal and heterogeneous link prediction in social networks</a>" PAKDD'12 - старенькая, лучше сразу смотреть кто цитировал</p>
<h1 id="_4">К след . разу:</h1>
<ol>
<li>Выгрузить данные из Dating бота в формате<ul>
<li>Nodes<ul>
<li>id</li>
<li>gender</li>
<li>reg date</li>
<li>…</li>
</ul>
</li>
<li>Edges<ul>
<li>id</li>
<li>node id A</li>
<li>node id B</li>
<li>timestamp</li>
<li>type</li>
</ul>
</li>
</ul>
</li>
<li>Загрузить данные в <a href="https://networkx.org/documentation/stable/reference/readwrite/index.html">NetworkX</a> и прогнать их через простенькие link prediction модели:<ul>
<li>Простые модели прогнозирвания, такие как preferential attachment, Adaic, Jaccard можно посмотреть тут: <a href="https://drive.google.com/file/d/1IVfBKPJo2rPHXgNim73WyYrj_ACtubcU/view?usp=sharing">colab</a></li>
<li>Чуть более умные модели на основании случайных блужданий и skipgram тут: <a href="https://drive.google.com/file/d/1PYNFGH5kHZwrX_hCykIyJpD6tyqZWioN/view?usp=sharing">colab</a></li>
</ul>
</li>
<li>Сделать обзор литературы по гайду выше в формате &lt;статья&gt;&lt;ключевая идея&gt;&lt;что понравилось&gt;&lt;что не понравилось&gt;</li>
</ol>
<h2 id="_5">Потом</h2>
<ul>
<li>Сделать описание сети (@ki расскажет как)</li>
<li>Начать разбираться с GAT</li>
</ul>
<h2 id="07052022">Статус 07.05.2022</h2>
<h3 id="1">1. Выгрузка данных и их очистка</h3>
<p><a href="https://drive.google.com/file/d/1d4UpPeKHibnjr85ryU5AjqNfawxJPC0k/view?usp=sharing">Выгрузил данные в 2 таблички</a>. Но есть нюанс - id это строчка начинающаюся с _. Это хеш телеграмного id с солью (В базе у нас только telegram_id, внутреннего нету). 
Это id я называю в ноутбуках dumb_id. 
Ещё если Петя вобьет в боте /photo dumb_id_1 dumb_id_2 ... то бот скинет фотки этих людей в порядке как они указаны.</p>
<p>Из-за того что мы хранили ребра по-тупом (по каждому человеку, по кажому типу список предктов и потомков) времени когда ребра появлялись нет, но есть <em>enum_number</em> - это индекс в списке <strong>исходящих</strong> рёбер у соответствующей вершины. 
Номер ребра в списке входящих я делать не стал, потому что там много не метчилось. Id ребра мне нигде не пригодилось, так что это закоментил.<br />
Если человек помечал анкету как нейтральную, а потом лайкал, то я проводил ребро как лайк. Дальше я считаю, что лайк или анонимный лайк это ребро (edge_type=pos), а нейтрально или дизлайк - нет (edge_type=neg).</p>
<p><a href="https://drive.google.com/file/d/13-gABQN4SvdRBynfAl2k1xRiMEq4oDeW/view?usp=sharing">Выгрузил картинки из s3</a>. Но как привести к общему виду не понял. Рандомная сетка, которая делает ембединги не заработала из-за greyscale картинок, по-быстрому пофиксить не смог.</p>
<h3 id="2">2. Граф</h3>
<p><a href="https://drive.google.com/file/d/1d4UpPeKHibnjr85ryU5AjqNfawxJPC0k/view?usp=sharing">Сделал направленный граф</a>. Ребра провел все - и по лайкам и по дизлайкам. 
Убрал гей ребра. Убрал изолированные вершины. Перенумеровал вершиные в графе, так чтобы номера шли от 0 последовательно.
Dumb_id вершины лежит в ее параметрах.</p>
<p>Немного статки подсчитал, чтобы понять что это вообще за граф. 
Ниже под лайком я буду понимать лайк или анонимный лайк. Для начала посмотрим на распредение степеней вершин. Видно, что многие не лайкают и просто заходят посмотреть.  </p>
<p><img alt="img_6.png" src="../Images/img_6.png" /></p>
<p>Всего 425к лайков. Метчей 43.6к Вот как лайки распределены по тому кто кого лайкает.</p>
<pre><code>male-&gt;male       1.22%  or    5168
male-&gt;female    65.76%  or  279502
female-&gt;male    29.00%  or  123285
female-&gt;female   4.02%  or   17106
</code></pre>
<p>Оценок всего 2.1М. Они распределены ровнее</p>
<pre><code>all edges male-&gt;male      1.57%  or   33150
all edges male-&gt;female   50.20%  or 1060399
all edges female-&gt;male   43.79%  or  924954
all edges female-&gt;female  4.43%  or   93639
</code></pre>
<p>Ну и посчитаем теперь какая доля от возможных ребер (если бы был полный граф) реально есть, и какая доля из них - лайки</p>
<pre><code>% existing edges from full graph m &lt;&gt; f 30.35%
% existing edges from full graph m -&gt; f 32.43%
% existing edges from full graph f -&gt; m 28.28%


% liked from existing edges m &lt;&gt; f 20.36%
% liked from existing edges m -&gt; f 26.47%
% liked from existing edges f -&gt; m 13.36%


% liked from full graph m &lt;&gt; f 6.18%
% liked from full graph m -&gt; f 8.58%
% liked from full graph f -&gt; m 3.78%
</code></pre>
<p>Довольно много <em>нетрадиционных</em> ребер. Посмотрим на распределение ориентаций</p>
<pre><code>male orientations %:
bi       8%
gay      9%
nat     84%

female orientations %:
bi      26%
gay     4%
nat     70%
</code></pre>
<p>Выводы:
- Несмотря на то что много людей помечают себя как би, основная доля ребер все-таки идёт <em>натурально</em>. Чтобы упростить задачу, оставим только натуральные ребра. 
- Средени оцененных ребер лайков <strong>много</strong> - в среднем 20%. Если бы все всех оценили, граф вышел бы совсем не разреженным. Поэтому я считаю, что нельзя по дефолту помечать отсутствующие ребра как негативыне, как это обычно делают
- Входящая степень лайков довольно сильно неровная -&gt; все лайкают одинх и тех же людей -&gt; ранжирование по популярности неплохо зайдет</p>
<h3 id="3">3. Несложные методы предсказания</h3>
<h5 id="testtrain">Test/train</h5>
<p>В ноутбуках я относительно много поменял. В test/train split ребра это лайки, 
а false ребра это теперь не все остальные, как обычно делают в разреженных графах, а neg ребра. 
Среди этих ребер нет ребер m-&gt;m или m-&gt;f для геев, так что наш алгос работает уже поверх логики, кто кого может оценивать.
Те чтобы получать его предсказания в реальном мире, надо будет ему скармливать только валидные пары.</p>
<h5 id="_6">Метрики</h5>
<p>Ещё меня смутили метрики. В статьях используют обычно f1, ap, auc. Однако я не смог осознать их смысл с продуктовой точки зрения.
Так что я буду дополнительно считать метрику, которую используют для рекомендательных систем. Я буду называть ее хитрейтом, обычно обозначают её <strong>@Pn</strong>. 
Чтобы посчитать, идем по всем вершинам и для каждой смотрим на все возможные элементы, которые можно ей порекомендовать (все возможные ребра из этой вершины), сортируем их по 
убыванию релевантности, берем топ <strong>n</strong> из них. И потом делим количество ребер которые мы порекомендовали и они реально есть 
на общее количество рекомендаций.</p>
<p>Чтобы считать корректно, я считаю эту метрику только по тестовым ребрам, те я могу рекомендовать только их. Однако из-за 
того что я ребра распределяю случайно, есть вершины с маленькой исходящей степенью. Для них если <strong>n</strong> больше чем их степень, 
я считаю, что порекомендовал все ребра. Из-за этого для случайных рекомендаций график @Pn от n - это не прямая линия. Потому что 
если pi - шанс что случайное ребро положительное для ребер исходящих из iй вершины, то @Pn = Sum(pi * wi) / sum(wi) где
веса это размеры рекомендаций. И когда обрезания нет - все веса одинаковые и это просто среднее вероятностей, а когда есть - 
у обрезанных, те вершин с маленькой степенью, вес меньше чем у тех, кого степень большая. А доля лайков по степени вершины 
распределена не равномерно. Ниже график @Pn от n. Синяя линия - по всем вершинам, рыжая - по ребрам со степенью &gt;100.</p>
<p><img alt="img.png" src="../Images/img_2.png" /></p>
<p>А вот средняя доля исходящих ребер по вершинам в зависимости от их степени с ci=95%</p>
<p><img alt="img_1.png" src="../Images/img_1.png" />
<em>по y - среднее средней доли лайков среди всех исходящих тестовых ребер. \
По x - исходящая степень округленная до 20 вниз</em></p>
<p>Получается, что результат рандомного классификатора не прямая линия - он колеблется от 19% до 20%. Однако по сравнению с 
дргуими методами, это колебание довольно маленькое и на общем графике, довольно близко к горизонтальной линии.
Все эти картинки посчитал в <a href="https://drive.google.com/file/d/1SzQMUemvPpnABf-FVCE9aQwMNjtyU0dd/view?usp=sharing">ноутбуке с node2vec</a></p>
<h5 id="_7">Простые вероятностные методы</h5>
<p>Всё в этом <a href="https://drive.google.com/file/d/1F7HJzGhtPVY1UeltAEFVOtVtlnSva_d8/view?usp=sharing">ноутбуке</a>. Простые методы, которые Adamic/Adar и другие, сделаны для ненаправленных графов. При этом у нас еще и граф двудольный. 
Поэтому чтобы побыстрее перейти к норм методам, я решил прогнать только preferential attachment, где считал
вероятность ребра a-&gt;b ~ deg_out(a) * deg_in(b). Получилось довольно хорошо: </p>
<pre><code>@P10    34.6%
AP      0.54
ROC     0.79
</code></pre>
<p><img alt="img_7.png" src="../Images/img_7.png" /></p>
<p>Насчет адаптации методов про общих друзей я думал сделать, что p ребра ~ как часто оно встречается у других людей вместе с 
другими вершинами которые тебе уже понравились. Те по всем u и v как часто встречается такая ситуация. Но я забил и решил 
пойти дальше</p>
<p><img alt="img_8.png" src="../Images/img_8.png" /></p>
<h5 id="node2vec">Node2vec</h5>
<p>Всё в этом <a href="https://drive.google.com/file/d/1SzQMUemvPpnABf-FVCE9aQwMNjtyU0dd/view?usp=sharing">ноутбуке</a>. Тут все довольно понятно. Единственное, что я поменял это то, как мы считаем эмбединг ребра. Из-за 
того, что граф направленный нелогично считать эмбединг симметрично. Я попробовал разность и конкатенацию.
Конкатенация зашла лучше</p>
<pre><code>Haddamard:
@P10    24.4%
AP      0.24
ROC     0.57

Concat:
@P10    33.1%
AP:     0.47
ROC:    0.77

Diff:
@P10    29.3%
AP      0.41
ROC     0.73
</code></pre>
<p>С гиперпараметрами я немного поигрался с руками с p, q, длинной и количество прогулок. Получилось p=1, q=2, NUM_WALKS=50, WALK_LENGTH = 10 лучше всего. Правда смотрел я это тоже на тесте.
Цифры выше при оптимальных параметрах</p>
<p>Вот график @Pn со всеми методами </p>
<p><img alt="sdfsd" src="../Images/img.png" /></p>
<h3 id="4">4. Обзор литературы</h3>
<p>Блин, я не смог и сделал <a href="https://www.notion.so/transition-pages/2199b5545075435e85dab57e88bd50cd">в ноушене</a>. Потом буду переносить все сюда. 
Посмотрел на статьи про графовые эмбединги и про рексис для китайского дейтинг сайта. 
Как буду идти дальше, буду добавлять статьи по ходу.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../Relevant%20Articles/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Relevant Articles" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Relevant Articles
            </div>
          </div>
        </a>
      
      
        
        <a href="../../Inflation/main/" class="md-footer__link md-footer__link--next" aria-label="Next: Встреча 30.03.2022" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Встреча 30.03.2022
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.ed9748b7.min.js"></script>
      
    
  </body>
</html>